{"ast":null,"code":"import _objectSpread from\"C:/Users/arpit/Documents/Agriconnect-master/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import axios from'axios';import{translations}from'../translations/translations';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const API_BASE='http://localhost:5000';function VoiceAssistant(_ref){let{language}=_ref;const[isListening,setIsListening]=useState(false);const[messages,setMessages]=useState([]);const[showChat,setShowChat]=useState(false);const[inputMessage,setInputMessage]=useState('');const[recognition,setRecognition]=useState(null);const[talkbackEnabled,setTalkbackEnabled]=useState(()=>{try{const v=localStorage.getItem('agri_talkback');return v===null?true:v==='true';}catch(e){return true;}});const[pendingIntent,setPendingIntent]=useState(null);const[pendingData,setPendingData]=useState(null);const[userLocation,setUserLocation]=useState(()=>{try{return localStorage.getItem('agri_location')||'';}catch(e){return'';}});const[expandedCards,setExpandedCards]=useState({});const[isLoading,setIsLoading]=useState(false);const[lastFailedIntent,setLastFailedIntent]=useState(null);const t=translations[language];useEffect(()=>{if('webkitSpeechRecognition'in window||'SpeechRecognition'in window){const SpeechRecognition=window.SpeechRecognition||window.webkitSpeechRecognition;const recog=new SpeechRecognition();recog.continuous=false;recog.interimResults=false;const langCode=language==='hi'?'hi-IN':language==='kn'?'kn-IN':'en-IN';recog.lang=langCode;recog.onresult=event=>{const transcript=event.results[0][0].transcript;handleSendMessage(transcript);};recog.onerror=event=>{console.error('Speech recognition error:',event.error);setIsListening(false);};recog.onend=()=>{setIsListening(false);};setRecognition(recog);}},[language]);const startListening=()=>{if(recognition){setIsListening(true);setShowChat(true);recognition.start();}else{alert('Speech recognition is not supported in your browser. Please use Chrome or Edge.');}};const handleSendMessage=async text=>{if(!text.trim())return;const userMessage={sender:'user',text:text};setMessages(prev=>[...prev,userMessage]);setInputMessage('');setIsLoading(true);// If waiting for a follow-up (e.g., soil type for crop rec), handle it first\nif(pendingIntent==='awaiting_soil_for_crop'){const soil=text.toLowerCase().trim();const season=(pendingData===null||pendingData===void 0?void 0:pendingData.season)||'';setPendingIntent(null);setPendingData(null);try{const params={params:{}};if(soil)params.params.soil=soil;if(season)params.params.season=season;const res=await axios.get(\"\".concat(API_BASE,\"/crop\"),params);const data=res.data;const card={type:'crop',data};card.id=Date.now()+Math.floor(Math.random()*1000);setMessages(prev=>[...prev,{sender:'bot',card}]);speakText(\"I found \".concat(data.count,\" recommended crops.\"));}catch(err){console.error('Crop fetch error (follow-up):',err);const errorMsg={sender:'bot',text:'Sorry, I could not fetch crop recommendations right now.',isError:true,retryIntent:'crop',retryData:{soil,season}};setMessages(prev=>[...prev,errorMsg]);setLastFailedIntent({type:'crop',data:{soil,season}});}setIsLoading(false);return;}const lower=text.toLowerCase();// Improved intent detection\nconst weatherKeywords=['weather','temperature','forecast','rain','humidity','mausam','‡§Æ‡•å‡§∏‡§Æ'];const isWeather=weatherKeywords.some(k=>lower.includes(k));// Extract location: handle multi-word locations like \"new delhi\", \"los angeles\"\nlet location='';const locMatch=lower.match(/in\\s+([a-z\\s]+?)(?:\\s+for|\\s+weather|$|\\.)/i)||lower.match(/weather\\s+(?:for|in)\\s+([a-z\\s]+?)(?:\\s+|$|\\.)/i);if(locMatch&&locMatch[1]){location=locMatch[1].trim();}if(isWeather){try{if(!location&&userLocation)location=userLocation;const params=location?{params:{location}}:{};const res=await axios.get(\"\".concat(API_BASE,\"/weather\"),params);const info=res.data;let botText=\"Weather for \".concat(info.location,\": \").concat(info.description,\". Temperature \").concat(info.temperature,\"\\xB0C (feels like \").concat(info.feels_like,\"\\xB0C). Humidity \").concat(info.humidity,\"%. Wind \").concat(info.wind_speed,\" m/s.\");if(info.alerts&&info.alerts.length){botText+='\\nAlerts:'+info.alerts.map(a=>\"\\n- \".concat(a.message)).join('');}if(info.forecast&&info.forecast.length){botText+='\\n\\nUpcoming forecast (next few entries):';info.forecast.slice(0,3).forEach(f=>{botText+=\"\\n\".concat(f.time,\": \").concat(f.temp,\"\\xB0C, \").concat(f.description);});}const card={type:'weather',info};card.id=Date.now()+Math.floor(Math.random()*1000);setMessages(prev=>[...prev,{sender:'bot',card}]);speakText(botText);}catch(err){console.error('Weather fetch error:',err);const errorMsg={sender:'bot',text:'Sorry, I could not fetch the weather right now.',isError:true,retryIntent:'weather',retryData:{location}};setMessages(prev=>[...prev,errorMsg]);setLastFailedIntent({type:'weather',data:{location}});}setIsLoading(false);return;}// Market prices intent\nconst marketKeywords=['price','prices','rate','rates','market','cost'];const isMarket=marketKeywords.some(k=>lower.includes(k));if(isMarket){try{// Extract crop name: handle multi-word crops like \"sugar cane\", \"black rice\"\nlet crop='';const m=lower.match(/(?:price|prices|rate|rates|cost)\\s+(?:of\\s+|for\\s+)?([a-z\\s]+?)(?:\\s+in|\\s+at|$|\\.)/i)||lower.match(/(?:for|of)\\s+([a-z\\s]+?)\\s+(?:prices?|rates?|cost|market)/i);if(m&&m[1])crop=m[1].trim();const params=crop?{params:{crop}}:{};const res=await axios.get(\"\".concat(API_BASE,\"/market\"),params);const data=res.data;const card={type:'market',data};card.id=Date.now()+Math.floor(Math.random()*1000);setMessages(prev=>[...prev,{sender:'bot',card}]);const summary=data.prices&&data.prices.length?\"Found \".concat(data.prices.length,\" market entries.\"):'No market price data found.';speakText(summary);}catch(err){console.error('Market fetch error:',err);const errorMsg={sender:'bot',text:'Sorry, I could not fetch market prices right now.',isError:true,retryIntent:'market',retryData:{}};setMessages(prev=>[...prev,errorMsg]);setLastFailedIntent({type:'market',data:{}});}setIsLoading(false);return;}// Crop recommendation intent\nconst cropKeywords=['crop','recommend','suggest','recommendation','suggestion','‡§ï‡•É‡§∑‡§ø','‡§´‡§∏‡§≤','‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂'];const isCrop=cropKeywords.some(k=>lower.includes(k));if(isCrop){try{// Extract soil and season (handle multi-word patterns)\nconst soilMatch=lower.match(/(clay|sandy|loamy|black|red|alluvial)/i);const seasonMatch=lower.match(/(kharif|rabi|summer|winter|monsoon|all)/i);const soil=soilMatch?soilMatch[1].toLowerCase():'';const season=seasonMatch?seasonMatch[1].toLowerCase():'';const params={params:{}};if(soil)params.params.soil=soil;if(season)params.params.season=season;const callParams=soil||season?params:{};const res=await axios.get(\"\".concat(API_BASE,\"/crop\"),callParams);const data=res.data;if(!soil){setPendingIntent('awaiting_soil_for_crop');setPendingData({season});const followUp={sender:'bot',text:'Which soil type do you have? (clay, sandy, loamy, black, red, alluvial)'};setMessages(prev=>[...prev,followUp]);speakText('Which soil type do you have?');setIsLoading(false);return;}const card={type:'crop',data};setMessages(prev=>[...prev,{sender:'bot',card}]);const summary=data.recommendations&&data.recommendations.length?\"Found \".concat(data.recommendations.length,\" recommendations.\"):'No crop recommendations found.';speakText(summary);}catch(err){console.error('Crop fetch error:',err);const errorMsg={sender:'bot',text:'Sorry, I could not fetch crop recommendations right now.',isError:true,retryIntent:'crop',retryData:{}};setMessages(prev=>[...prev,errorMsg]);setLastFailedIntent({type:'crop',data:{}});}setIsLoading(false);return;}// Fallback to existing chatbot endpoint for other intents\ntry{const response=await axios.post(\"\".concat(API_BASE,\"/chatbot\"),{message:text,language:language});const botMessage={sender:'bot',text:response.data.response};setMessages(prev=>[...prev,botMessage]);speakText(response.data.response);}catch(error){console.error('Error with chatbot:',error);const errorMsg={sender:'bot',text:'Sorry, I encountered an error. Please try again.',isError:true,retryIntent:'general',retryData:{}};setMessages(prev=>[...prev,errorMsg]);}setIsLoading(false);};const speakText=text=>{if(!talkbackEnabled)return;if('speechSynthesis'in window){const utterance=new SpeechSynthesisUtterance(text);utterance.lang=language==='hi'?'hi-IN':language==='kn'?'kn-IN':'en-IN';utterance.rate=0.9;window.speechSynthesis.speak(utterance);}};const toggleTalkback=()=>{setTalkbackEnabled(prev=>{const next=!prev;try{localStorage.setItem('agri_talkback',next?'true':'false');}catch(e){}// If turning off, stop any active speech\nif(!next&&'speechSynthesis'in window){window.speechSynthesis.cancel();}return next;});};// Toggle expand/collapse for a card\nconst handleToggleExpand=cardId=>{setExpandedCards(prev=>_objectSpread(_objectSpread({},prev),{},{[cardId]:!prev[cardId]}));};// Set user's saved location (persisted)\nconst handleSetLocation=location=>{if(!location)return;// ask the user to confirm\nconst ok=window.confirm(\"Save \".concat(location,\" as your default location?\"));if(!ok)return;try{localStorage.setItem('agri_location',location);}catch(e){}setUserLocation(location);const confirm={sender:'bot',text:\"Location saved: \".concat(location)};setMessages(prev=>[...prev,confirm]);speakText(\"Location saved as \".concat(location));};// Open a page in the app by dispatching a custom event the App listens to\nconst handleOpenPage=page=>{try{window.dispatchEvent(new CustomEvent('agri:navigate',{detail:page}));}catch(e){// fallback: open root\nwindow.location.href='/';}};// Save a crop (object) to favorites in localStorage\nconst handleSaveFavoriteCrop=crop=>{if(!crop||!crop.name)return;try{const raw=localStorage.getItem('agri_favorites');const favs=raw?JSON.parse(raw):[];// avoid duplicates by name\nif(!favs.find(f=>f.name===crop.name)){favs.push(crop);localStorage.setItem('agri_favorites',JSON.stringify(favs));const confirm={sender:'bot',text:\"\".concat(crop.name,\" saved to favorites.\")};setMessages(prev=>[...prev,confirm]);speakText(\"\".concat(crop.name,\" saved to favorites\"));}else{const confirm={sender:'bot',text:\"\".concat(crop.name,\" is already in favorites.\")};setMessages(prev=>[...prev,confirm]);}}catch(e){const errorMsg={sender:'bot',text:'Could not save favorite right now.'};setMessages(prev=>[...prev,errorMsg]);}};// Retry failed API call\nconst handleRetry=()=>{if(!lastFailedIntent)return;const{type,data}=lastFailedIntent;let retryText='';if(type==='weather'){retryText=data.location?\"weather in \".concat(data.location):'weather';}else if(type==='market'){retryText='market prices';}else if(type==='crop'){retryText='crop recommendations';}else{retryText='retry';}handleSendMessage(retryText);};return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{className:\"voice-btn \".concat(isListening?'listening':''),onClick:isListening?null:startListening,title:t.voiceAssistant,children:\"\\uD83C\\uDFA4\"}),showChat&&/*#__PURE__*/_jsxs(\"div\",{style:{position:'fixed',bottom:'100px',right:'30px',width:'500px',maxHeight:'650px',background:'rgba(255, 255, 255, 0.2)',backdropFilter:'blur(10px)',borderRadius:'10px',boxShadow:'0 4px 12px rgba(0, 0, 0, 0.3)',display:'flex',flexDirection:'column',zIndex:1000},children:[/*#__PURE__*/_jsxs(\"div\",{style:{background:'#3f5945',color:'white',padding:'15px',borderTopLeftRadius:'10px',borderTopRightRadius:'10px',display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"h3\",{style:{margin:0},children:[\"\\uD83E\\uDD16 \",t.aiAssistant]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowChat(false),style:{background:'none',border:'none',color:'white',fontSize:'20px',cursor:'pointer'},children:\"\\u2715\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"chat-container\",style:{flex:1,padding:'15px',overflowY:'auto'},children:[messages.length===0&&/*#__PURE__*/_jsxs(\"div\",{style:{textAlign:'center',color:'#222',padding:'20px'},children:[/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'16px',fontWeight:'bold'},children:[\"\\uD83D\\uDC4B \",t.hiMessage]}),/*#__PURE__*/_jsxs(\"p\",{style:{fontSize:'15px',marginBottom:'15px'},children:[\"\\uD83C\\uDFA4 \",/*#__PURE__*/_jsx(\"strong\",{children:\"Try a voice query!\"}),\" Click Record and ask me anything about:\"]}),/*#__PURE__*/_jsxs(\"ul\",{style:{textAlign:'left',marginTop:'10px',fontSize:'14px'},children:[/*#__PURE__*/_jsxs(\"li\",{children:[\"\\u2600\\uFE0F \",t.weatherUpdates]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\uD83C\\uDF3E \",t.cropRecommendations]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\uD83D\\uDCB0 \",t.marketPricesVoice]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\uD83D\\uDCDC \",t.govSchemesVoice]}),/*#__PURE__*/_jsxs(\"li\",{children:[\"\\uD83E\\uDDA0 \",t.diseaseDetectionVoice]})]}),/*#__PURE__*/_jsx(\"p\",{style:{fontSize:'12px',marginTop:'15px',color:'#666'},children:\"Examples: \\\"weather in delhi\\\", \\\"sugar cane prices\\\", \\\"crops for clay soil\\\"\"})]}),isLoading&&/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'10px',padding:'10px',borderRadius:'8px',background:'rgba(255, 255, 255, 0.2)',color:'#222',textAlign:'center'},children:[/*#__PURE__*/_jsx(\"span\",{children:\"\\u23F3 Loading\"}),/*#__PURE__*/_jsx(\"span\",{style:{animation:'blink 1.4s infinite',marginLeft:'4px'},children:\"\\u2022\\u2022\\u2022\"}),/*#__PURE__*/_jsx(\"style\",{children:\"\\n                  @keyframes blink {\\n                    0%, 20%, 50%, 80%, 100% { opacity: 1; }\\n                    40% { opacity: 0.5; }\\n                    60% { opacity: 0.7; }\\n                  }\\n                \"})]}),messages.map((msg,index)=>{// Render error messages with retry button\nif(msg.isError){return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'10px',padding:'10px',borderRadius:'8px',background:'rgba(220, 53, 69, 0.15)',color:'#a33',borderLeft:'3px solid #dc3545'},children:[/*#__PURE__*/_jsx(\"div\",{children:msg.text}),/*#__PURE__*/_jsx(\"button\",{onClick:handleRetry,style:{marginTop:'8px',padding:'6px 12px',borderRadius:'4px',border:'none',background:'#dc3545',color:'white',cursor:'pointer',fontSize:'13px'},children:\"\\uD83D\\uDD04 Retry\"})]},index);}// Render structured cards when present\nif(msg.card){const card=msg.card;if(card.type==='weather'){const info=card.info;const isExpanded=expandedCards[card.id];return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px',padding:'12px',borderRadius:'8px',background:'rgba(255,255,255,0.95)',color:'#222',boxShadow:'0 2px 6px rgba(0,0,0,0.08)',maxWidth:'460px'},children:[/*#__PURE__*/_jsxs(\"strong\",{style:{fontSize:'17px'},children:[\"Weather \\u2014 \",info.location]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'6px',fontSize:'17px'},children:[info.description,\" \\u2022 \",info.temperature,\"\\xB0C (feels \",info.feels_like,\"\\xB0C)\"]}),/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'16px',marginTop:'6px'},children:[\"Humidity: \",info.humidity,\"% \\u2022 Wind: \",info.wind_speed,\" m/s\"]}),info.alerts&&info.alerts.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',color:'#a33'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'16px'},children:\"Alerts:\"}),/*#__PURE__*/_jsx(\"ul\",{style:{margin:'6px 0 0 16px',fontSize:'15px'},children:info.alerts.map((a,i)=>/*#__PURE__*/_jsx(\"li\",{children:a.message},i))})]}),info.forecast&&info.forecast.length>0&&/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'16px'},children:\"Forecast:\"}),/*#__PURE__*/_jsx(\"ul\",{style:{margin:'6px 0 0 16px',fontSize:'15px'},children:(isExpanded?info.forecast:info.forecast.slice(0,3)).map((f,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[f.time,\": \",f.temp,\"\\xB0C \\u2014 \",f.description]},i))})]}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleToggleExpand(card.id),style:{padding:'8px 12px',borderRadius:'6px',border:'none',cursor:'pointer',background:'#3b4f1b',color:'white',fontSize:'14px'},children:isExpanded?'View less':'View more'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleOpenPage('weather'),style:{padding:'8px 12px',borderRadius:'6px',border:'1px solid #3b4f1b',cursor:'pointer',background:'white',color:'#3b4f1b',fontSize:'14px'},children:\"Open Weather Page\"}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSetLocation(info.location),style:{padding:'8px 12px',borderRadius:'6px',border:'1px solid #3b4f1b',cursor:'pointer',background:'white',color:'#3b4f1b',fontSize:'14px'},children:\"Set as my location\"})]})]},card.id);}if(card.type==='market'){const data=card.data;const isExpanded=expandedCards[card.id];const firstLoc=data.prices&&data.prices[0]?data.prices[0].location:'';return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px',padding:'12px',borderRadius:'8px',background:'rgba(255,255,255,0.95)',color:'#222',boxShadow:'0 2px 6px rgba(0,0,0,0.08)',maxWidth:'460px'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'15px'},children:\"Market Prices\"}),data.prices&&data.prices.length?/*#__PURE__*/_jsx(\"ul\",{style:{margin:'8px 0 0 16px',fontSize:'13px'},children:(isExpanded?data.prices:data.prices.slice(0,5)).map((p,i)=>/*#__PURE__*/_jsxs(\"li\",{children:[p.crop,\" \\u2014 \",p.location,\": \\u20B9\",p.current_price,\" (\",p.change>=0?'+'+p.change:p.change,\")\"]},i))}):/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'6px',fontSize:'14px'},children:\"No market data found.\"}),/*#__PURE__*/_jsxs(\"div\",{style:{marginTop:'8px',display:'flex',gap:'8px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleToggleExpand(card.id),style:{padding:'6px 10px',borderRadius:'6px',border:'none',cursor:'pointer',background:'#3b4f1b',color:'white'},children:isExpanded?'View less':'View more'}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleOpenPage('market'),style:{padding:'6px 10px',borderRadius:'6px',border:'1px solid #3b4f1b',cursor:'pointer',background:'white',color:'#3b4f1b'},children:\"Open Market Page\"}),firstLoc&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSetLocation(firstLoc),style:{padding:'6px 10px',borderRadius:'6px',border:'1px solid #3b4f1b',cursor:'pointer',background:'white',color:'#3b4f1b'},children:\"Set as my location\"})]})]},card.id);}if(card.type==='crop'){const data=card.data;const isExpanded=expandedCards[card.id];return/*#__PURE__*/_jsxs(\"div\",{style:{marginBottom:'12px',padding:'12px',borderRadius:'8px',background:'rgba(255,255,255,0.95)',color:'#222',boxShadow:'0 2px 6px rgba(0,0,0,0.08)',maxWidth:'460px'},children:[/*#__PURE__*/_jsx(\"strong\",{style:{fontSize:'15px'},children:\"Crop Recommendations\"}),data.recommendations&&data.recommendations.length?/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"ul\",{style:{margin:'8px 0 0 16px',fontSize:'13px'},children:(isExpanded?data.recommendations:data.recommendations.slice(0,4)).map((r,i)=>/*#__PURE__*/_jsxs(\"li\",{style:{marginBottom:'8px'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',justifyContent:'space-between',alignItems:'center'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:r.name}),\" \\u2014 \",r.duration||'',\" \",r.yield?\"\\u2022 yield: \".concat(r.yield):'']}),isExpanded&&/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSaveFavoriteCrop(r),style:{padding:'4px 8px',borderRadius:'6px',border:'none',background:'#3b4f1b',color:'white',cursor:'pointer',fontSize:'12px'},children:\"Save\"})]}),isExpanded&&/*#__PURE__*/_jsxs(\"div\",{style:{fontSize:'12px',marginTop:'4px',marginLeft:'8px',color:'#444'},children:[/*#__PURE__*/_jsxs(\"div\",{children:[\"Soil: \",r.soil_types?r.soil_types.join(', '):'‚Äî']}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Water: \",r.water_requirement||'‚Äî']}),/*#__PURE__*/_jsxs(\"div\",{children:[\"Fertilizers: \",r.fertilizers?r.fertilizers.join(', '):'‚Äî']})]})]},i))}),/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'8px',display:'flex',gap:'8px'},children:/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleToggleExpand(card.id),style:{padding:'6px 10px',borderRadius:'6px',border:'none',cursor:'pointer',background:'#3b4f1b',color:'white'},children:isExpanded?'View less':'View more'})})]}):/*#__PURE__*/_jsx(\"div\",{style:{marginTop:'6px',fontSize:'14px'},children:\"No recommendations found.\"})]},card.id);}}// Default text message rendering\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"message \".concat(msg.sender),style:{marginBottom:'10px',padding:'10px',borderRadius:'8px',maxWidth:'80%',marginLeft:msg.sender==='user'?'auto':'0',background:msg.sender==='user'?'#3b4f1b':'rgba(255, 255, 255, 0.2)',backdropFilter:msg.sender==='bot'?'blur(10px)':'none',color:msg.sender==='user'?'white':'#222',fontSize:'14px'},children:msg.text},index);})]}),/*#__PURE__*/_jsxs(\"div\",{style:{padding:'15px',borderTop:'1px solid #e0e0e0'},children:[/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px',marginBottom:'10px'},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:inputMessage,onChange:e=>setInputMessage(e.target.value),onKeyPress:e=>e.key==='Enter'&&handleSendMessage(inputMessage),style:{flex:1,padding:'10px',border:'2px solid #3b4f1b',borderRadius:'5px',fontSize:'16px',background:'rgba(255, 255, 255, 0.2)',backdropFilter:'blur(10px)',color:'#222'}}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>handleSendMessage(inputMessage),className:\"btn\",style:{padding:'10px 20px',margin:0,fontSize:'16px'},children:t.send})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:'flex',gap:'10px'},children:[/*#__PURE__*/_jsx(\"button\",{onClick:startListening,className:\"btn\",style:{flex:1,padding:'10px 15px',margin:0,background:isListening?'#dc3545':'#3b4f1b',fontSize:'16px'},disabled:isListening,children:\"\\uD83C\\uDFA4 Record\"}),/*#__PURE__*/_jsxs(\"button\",{onClick:toggleTalkback,className:\"btn\",style:{flex:1,padding:'10px 12px',margin:0,background:talkbackEnabled?'#3b4f1b':'#999',display:'flex',alignItems:'center',justifyContent:'center',gap:'6px',fontSize:'16px'},title:talkbackEnabled?'Talkback enabled':'Talkback disabled',children:[talkbackEnabled?'üîä':'üîá',\" \",talkbackEnabled?'On':'Off']})]})]})]})]});}export default VoiceAssistant;","map":{"version":3,"names":["React","useState","useEffect","axios","translations","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","API_BASE","VoiceAssistant","_ref","language","isListening","setIsListening","messages","setMessages","showChat","setShowChat","inputMessage","setInputMessage","recognition","setRecognition","talkbackEnabled","setTalkbackEnabled","v","localStorage","getItem","e","pendingIntent","setPendingIntent","pendingData","setPendingData","userLocation","setUserLocation","expandedCards","setExpandedCards","isLoading","setIsLoading","lastFailedIntent","setLastFailedIntent","t","window","SpeechRecognition","webkitSpeechRecognition","recog","continuous","interimResults","langCode","lang","onresult","event","transcript","results","handleSendMessage","onerror","console","error","onend","startListening","start","alert","text","trim","userMessage","sender","prev","soil","toLowerCase","season","params","res","get","concat","data","card","type","id","Date","now","Math","floor","random","speakText","count","err","errorMsg","isError","retryIntent","retryData","lower","weatherKeywords","isWeather","some","k","includes","location","locMatch","match","info","botText","description","temperature","feels_like","humidity","wind_speed","alerts","length","map","a","message","join","forecast","slice","forEach","f","time","temp","marketKeywords","isMarket","crop","m","summary","prices","cropKeywords","isCrop","soilMatch","seasonMatch","callParams","followUp","recommendations","response","post","botMessage","utterance","SpeechSynthesisUtterance","rate","speechSynthesis","speak","toggleTalkback","next","setItem","cancel","handleToggleExpand","cardId","_objectSpread","handleSetLocation","ok","confirm","handleOpenPage","page","dispatchEvent","CustomEvent","detail","href","handleSaveFavoriteCrop","name","raw","favs","JSON","parse","find","push","stringify","handleRetry","retryText","children","className","onClick","title","voiceAssistant","style","position","bottom","right","width","maxHeight","background","backdropFilter","borderRadius","boxShadow","display","flexDirection","zIndex","color","padding","borderTopLeftRadius","borderTopRightRadius","justifyContent","alignItems","margin","aiAssistant","border","fontSize","cursor","flex","overflowY","textAlign","fontWeight","hiMessage","marginBottom","marginTop","weatherUpdates","cropRecommendations","marketPricesVoice","govSchemesVoice","diseaseDetectionVoice","animation","marginLeft","msg","index","borderLeft","isExpanded","maxWidth","i","gap","firstLoc","p","current_price","change","r","duration","yield","soil_types","water_requirement","fertilizers","borderTop","value","onChange","target","onKeyPress","key","send","disabled"],"sources":["C:/Users/arpit/Documents/Agriconnect-master/frontend/src/components/VoiceAssistant.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { translations } from '../translations/translations';\n\nconst API_BASE = 'http://localhost:5000';\n\nfunction VoiceAssistant({ language }) {\n  const [isListening, setIsListening] = useState(false);\n  const [messages, setMessages] = useState([]);\n  const [showChat, setShowChat] = useState(false);\n  const [inputMessage, setInputMessage] = useState('');\n  const [recognition, setRecognition] = useState(null);\n  const [talkbackEnabled, setTalkbackEnabled] = useState(() => {\n    try {\n      const v = localStorage.getItem('agri_talkback');\n      return v === null ? true : v === 'true';\n    } catch (e) {\n      return true;\n    }\n  });\n  const [pendingIntent, setPendingIntent] = useState(null);\n  const [pendingData, setPendingData] = useState(null);\n  const [userLocation, setUserLocation] = useState(() => {\n    try {\n      return localStorage.getItem('agri_location') || '';\n    } catch (e) {\n      return '';\n    }\n  });\n  const [expandedCards, setExpandedCards] = useState({});\n  const [isLoading, setIsLoading] = useState(false);\n  const [lastFailedIntent, setLastFailedIntent] = useState(null);\n  const t = translations[language];\n\n  useEffect(() => {\n    if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {\n      const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;\n      const recog = new SpeechRecognition();\n      recog.continuous = false;\n      recog.interimResults = false;\n      \n      const langCode = language === 'hi' ? 'hi-IN' : language === 'kn' ? 'kn-IN' : 'en-IN';\n      recog.lang = langCode;\n\n      recog.onresult = (event) => {\n        const transcript = event.results[0][0].transcript;\n        handleSendMessage(transcript);\n      };\n\n      recog.onerror = (event) => {\n        console.error('Speech recognition error:', event.error);\n        setIsListening(false);\n      };\n\n      recog.onend = () => {\n        setIsListening(false);\n      };\n\n      setRecognition(recog);\n    }\n  }, [language]);\n\n  const startListening = () => {\n    if (recognition) {\n      setIsListening(true);\n      setShowChat(true);\n      recognition.start();\n    } else {\n      alert('Speech recognition is not supported in your browser. Please use Chrome or Edge.');\n    }\n  };\n\n  const handleSendMessage = async (text) => {\n    if (!text.trim()) return;\n\n    const userMessage = { sender: 'user', text: text };\n    setMessages(prev => [...prev, userMessage]);\n    setInputMessage('');\n    setIsLoading(true);\n\n    // If waiting for a follow-up (e.g., soil type for crop rec), handle it first\n    if (pendingIntent === 'awaiting_soil_for_crop') {\n      const soil = text.toLowerCase().trim();\n      const season = pendingData?.season || '';\n      setPendingIntent(null);\n      setPendingData(null);\n\n      try {\n        const params = { params: {} };\n        if (soil) params.params.soil = soil;\n        if (season) params.params.season = season;\n        const res = await axios.get(`${API_BASE}/crop`, params);\n        const data = res.data;\n\n        const card = { type: 'crop', data };\n        card.id = Date.now() + Math.floor(Math.random() * 1000);\n        setMessages(prev => [...prev, { sender: 'bot', card }]);\n        speakText(`I found ${data.count} recommended crops.`);\n      } catch (err) {\n        console.error('Crop fetch error (follow-up):', err);\n        const errorMsg = { sender: 'bot', text: 'Sorry, I could not fetch crop recommendations right now.', isError: true, retryIntent: 'crop', retryData: { soil, season } };\n        setMessages(prev => [...prev, errorMsg]);\n        setLastFailedIntent({ type: 'crop', data: { soil, season } });\n      }\n      setIsLoading(false);\n      return;\n    }\n\n    const lower = text.toLowerCase();\n\n    // Improved intent detection\n    const weatherKeywords = ['weather', 'temperature', 'forecast', 'rain', 'humidity', 'mausam', '‡§Æ‡•å‡§∏‡§Æ'];\n    const isWeather = weatherKeywords.some(k => lower.includes(k));\n\n    // Extract location: handle multi-word locations like \"new delhi\", \"los angeles\"\n    let location = '';\n    const locMatch = lower.match(/in\\s+([a-z\\s]+?)(?:\\s+for|\\s+weather|$|\\.)/i) || lower.match(/weather\\s+(?:for|in)\\s+([a-z\\s]+?)(?:\\s+|$|\\.)/i);\n    if (locMatch && locMatch[1]) {\n      location = locMatch[1].trim();\n    }\n\n    if (isWeather) {\n      try {\n        if (!location && userLocation) location = userLocation;\n        const params = location ? { params: { location } } : {};\n        const res = await axios.get(`${API_BASE}/weather`, params);\n        const info = res.data;\n\n        let botText = `Weather for ${info.location}: ${info.description}. Temperature ${info.temperature}¬∞C (feels like ${info.feels_like}¬∞C). Humidity ${info.humidity}%. Wind ${info.wind_speed} m/s.`;\n        if (info.alerts && info.alerts.length) {\n          botText += '\\nAlerts:' + info.alerts.map(a => `\\n- ${a.message}`).join('');\n        }\n\n        if (info.forecast && info.forecast.length) {\n          botText += '\\n\\nUpcoming forecast (next few entries):';\n          info.forecast.slice(0, 3).forEach(f => {\n            botText += `\\n${f.time}: ${f.temp}¬∞C, ${f.description}`;\n          });\n        }\n\n        const card = { type: 'weather', info };\n        card.id = Date.now() + Math.floor(Math.random() * 1000);\n        setMessages(prev => [...prev, { sender: 'bot', card }]);\n        speakText(botText);\n      } catch (err) {\n        console.error('Weather fetch error:', err);\n        const errorMsg = { sender: 'bot', text: 'Sorry, I could not fetch the weather right now.', isError: true, retryIntent: 'weather', retryData: { location } };\n        setMessages(prev => [...prev, errorMsg]);\n        setLastFailedIntent({ type: 'weather', data: { location } });\n      }\n      setIsLoading(false);\n      return;\n    }\n\n    // Market prices intent\n    const marketKeywords = ['price', 'prices', 'rate', 'rates', 'market', 'cost'];\n    const isMarket = marketKeywords.some(k => lower.includes(k));\n\n    if (isMarket) {\n      try {\n        // Extract crop name: handle multi-word crops like \"sugar cane\", \"black rice\"\n        let crop = '';\n        const m = lower.match(/(?:price|prices|rate|rates|cost)\\s+(?:of\\s+|for\\s+)?([a-z\\s]+?)(?:\\s+in|\\s+at|$|\\.)/i) || lower.match(/(?:for|of)\\s+([a-z\\s]+?)\\s+(?:prices?|rates?|cost|market)/i);\n        if (m && m[1]) crop = m[1].trim();\n\n        const params = crop ? { params: { crop } } : {};\n        const res = await axios.get(`${API_BASE}/market`, params);\n        const data = res.data;\n\n        const card = { type: 'market', data };\n        card.id = Date.now() + Math.floor(Math.random() * 1000);\n        setMessages(prev => [...prev, { sender: 'bot', card }]);\n        const summary = data.prices && data.prices.length ? `Found ${data.prices.length} market entries.` : 'No market price data found.';\n        speakText(summary);\n      } catch (err) {\n        console.error('Market fetch error:', err);\n        const errorMsg = { sender: 'bot', text: 'Sorry, I could not fetch market prices right now.', isError: true, retryIntent: 'market', retryData: {} };\n        setMessages(prev => [...prev, errorMsg]);\n        setLastFailedIntent({ type: 'market', data: {} });\n      }\n      setIsLoading(false);\n      return;\n    }\n\n    // Crop recommendation intent\n    const cropKeywords = ['crop', 'recommend', 'suggest', 'recommendation', 'suggestion', '‡§ï‡•É‡§∑‡§ø', '‡§´‡§∏‡§≤', '‡§∏‡§ø‡§´‡§æ‡§∞‡§ø‡§∂'];\n    const isCrop = cropKeywords.some(k => lower.includes(k));\n\n    if (isCrop) {\n      try {\n        // Extract soil and season (handle multi-word patterns)\n        const soilMatch = lower.match(/(clay|sandy|loamy|black|red|alluvial)/i);\n        const seasonMatch = lower.match(/(kharif|rabi|summer|winter|monsoon|all)/i);\n        const soil = soilMatch ? soilMatch[1].toLowerCase() : '';\n        const season = seasonMatch ? seasonMatch[1].toLowerCase() : '';\n\n        const params = { params: {} };\n        if (soil) params.params.soil = soil;\n        if (season) params.params.season = season;\n\n        const callParams = (soil || season) ? params : {};\n        const res = await axios.get(`${API_BASE}/crop`, callParams);\n        const data = res.data;\n\n        if (!soil) {\n          setPendingIntent('awaiting_soil_for_crop');\n          setPendingData({ season });\n          const followUp = { sender: 'bot', text: 'Which soil type do you have? (clay, sandy, loamy, black, red, alluvial)' };\n          setMessages(prev => [...prev, followUp]);\n          speakText('Which soil type do you have?');\n          setIsLoading(false);\n          return;\n        }\n\n        const card = { type: 'crop', data };\n        setMessages(prev => [...prev, { sender: 'bot', card }]);\n        const summary = data.recommendations && data.recommendations.length ? `Found ${data.recommendations.length} recommendations.` : 'No crop recommendations found.';\n        speakText(summary);\n      } catch (err) {\n        console.error('Crop fetch error:', err);\n        const errorMsg = { sender: 'bot', text: 'Sorry, I could not fetch crop recommendations right now.', isError: true, retryIntent: 'crop', retryData: {} };\n        setMessages(prev => [...prev, errorMsg]);\n        setLastFailedIntent({ type: 'crop', data: {} });\n      }\n      setIsLoading(false);\n      return;\n    }\n\n    // Fallback to existing chatbot endpoint for other intents\n    try {\n      const response = await axios.post(`${API_BASE}/chatbot`, {\n        message: text,\n        language: language\n      });\n\n      const botMessage = { sender: 'bot', text: response.data.response };\n      setMessages(prev => [...prev, botMessage]);\n\n      speakText(response.data.response);\n    } catch (error) {\n      console.error('Error with chatbot:', error);\n      const errorMsg = { sender: 'bot', text: 'Sorry, I encountered an error. Please try again.', isError: true, retryIntent: 'general', retryData: {} };\n      setMessages(prev => [...prev, errorMsg]);\n    }\n    setIsLoading(false);\n  };\n\n  const speakText = (text) => {\n    if (!talkbackEnabled) return;\n    if ('speechSynthesis' in window) {\n      const utterance = new SpeechSynthesisUtterance(text);\n      utterance.lang = language === 'hi' ? 'hi-IN' : language === 'kn' ? 'kn-IN' : 'en-IN';\n      utterance.rate = 0.9;\n      window.speechSynthesis.speak(utterance);\n    }\n  };\n\n  const toggleTalkback = () => {\n    setTalkbackEnabled(prev => {\n      const next = !prev;\n      try { localStorage.setItem('agri_talkback', next ? 'true' : 'false'); } catch (e) {}\n      // If turning off, stop any active speech\n      if (!next && 'speechSynthesis' in window) {\n        window.speechSynthesis.cancel();\n      }\n      return next;\n    });\n  };\n\n  // Toggle expand/collapse for a card\n  const handleToggleExpand = (cardId) => {\n    setExpandedCards(prev => ({ ...prev, [cardId]: !prev[cardId] }));\n  };\n\n  // Set user's saved location (persisted)\n  const handleSetLocation = (location) => {\n    if (!location) return;\n    // ask the user to confirm\n    const ok = window.confirm(`Save ${location} as your default location?`);\n    if (!ok) return;\n    try {\n      localStorage.setItem('agri_location', location);\n    } catch (e) {}\n    setUserLocation(location);\n    const confirm = { sender: 'bot', text: `Location saved: ${location}` };\n    setMessages(prev => [...prev, confirm]);\n    speakText(`Location saved as ${location}`);\n  };\n\n  // Open a page in the app by dispatching a custom event the App listens to\n  const handleOpenPage = (page) => {\n    try {\n      window.dispatchEvent(new CustomEvent('agri:navigate', { detail: page }));\n    } catch (e) {\n      // fallback: open root\n      window.location.href = '/';\n    }\n  };\n\n  // Save a crop (object) to favorites in localStorage\n  const handleSaveFavoriteCrop = (crop) => {\n    if (!crop || !crop.name) return;\n    try {\n      const raw = localStorage.getItem('agri_favorites');\n      const favs = raw ? JSON.parse(raw) : [];\n      // avoid duplicates by name\n      if (!favs.find(f => f.name === crop.name)) {\n        favs.push(crop);\n        localStorage.setItem('agri_favorites', JSON.stringify(favs));\n        const confirm = { sender: 'bot', text: `${crop.name} saved to favorites.` };\n        setMessages(prev => [...prev, confirm]);\n        speakText(`${crop.name} saved to favorites`);\n      } else {\n        const confirm = { sender: 'bot', text: `${crop.name} is already in favorites.` };\n        setMessages(prev => [...prev, confirm]);\n      }\n    } catch (e) {\n      const errorMsg = { sender: 'bot', text: 'Could not save favorite right now.' };\n      setMessages(prev => [...prev, errorMsg]);\n    }\n  };\n\n  // Retry failed API call\n  const handleRetry = () => {\n    if (!lastFailedIntent) return;\n    const { type, data } = lastFailedIntent;\n    \n    let retryText = '';\n    if (type === 'weather') {\n      retryText = data.location ? `weather in ${data.location}` : 'weather';\n    } else if (type === 'market') {\n      retryText = 'market prices';\n    } else if (type === 'crop') {\n      retryText = 'crop recommendations';\n    } else {\n      retryText = 'retry';\n    }\n    \n    handleSendMessage(retryText);\n  };\n\n  return (\n    <>\n      <button\n        className={`voice-btn ${isListening ? 'listening' : ''}`}\n        onClick={isListening ? null : startListening}\n        title={t.voiceAssistant}\n      >\n        üé§\n      </button>\n\n      {showChat && (\n        <div style={{\n          position: 'fixed',\n          bottom: '100px',\n          right: '30px',\n          width: '500px',\n          maxHeight: '650px',\n          background: 'rgba(255, 255, 255, 0.2)',\n          backdropFilter: 'blur(10px)',\n          borderRadius: '10px',\n          boxShadow: '0 4px 12px rgba(0, 0, 0, 0.3)',\n          display: 'flex',\n          flexDirection: 'column',\n          zIndex: 1000\n        }}>\n          <div style={{\n            background: '#3f5945',\n            color: 'white',\n            padding: '15px',\n            borderTopLeftRadius: '10px',\n            borderTopRightRadius: '10px',\n            display: 'flex',\n            justifyContent: 'space-between',\n            alignItems: 'center'\n          }}>\n            <h3 style={{ margin: 0 }}>ü§ñ {t.aiAssistant}</h3>\n            <button\n              onClick={() => setShowChat(false)}\n              style={{\n                background: 'none',\n                border: 'none',\n                color: 'white',\n                fontSize: '20px',\n                cursor: 'pointer'\n              }}\n            >\n              ‚úï\n            </button>\n          </div>\n\n          <div className=\"chat-container\" style={{ flex: 1, padding: '15px', overflowY: 'auto' }}>\n            {messages.length === 0 && (\n              <div style={{ textAlign: 'center', color: '#222', padding: '20px' }}>\n                <p style={{ fontSize: '16px', fontWeight: 'bold' }}>üëã {t.hiMessage}</p>\n                <p style={{ fontSize: '15px', marginBottom: '15px' }}>üé§ <strong>Try a voice query!</strong> Click Record and ask me anything about:</p>\n                <ul style={{ textAlign: 'left', marginTop: '10px', fontSize: '14px' }}>\n                  <li>‚òÄÔ∏è {t.weatherUpdates}</li>\n                  <li>üåæ {t.cropRecommendations}</li>\n                  <li>üí∞ {t.marketPricesVoice}</li>\n                  <li>üìú {t.govSchemesVoice}</li>\n                  <li>ü¶† {t.diseaseDetectionVoice}</li>\n                </ul>\n                <p style={{ fontSize: '12px', marginTop: '15px', color: '#666' }}>Examples: \"weather in delhi\", \"sugar cane prices\", \"crops for clay soil\"</p>\n              </div>\n            )}\n            {isLoading && (\n              <div style={{ marginBottom: '10px', padding: '10px', borderRadius: '8px', background: 'rgba(255, 255, 255, 0.2)', color: '#222', textAlign: 'center' }}>\n                <span>‚è≥ Loading</span>\n                <span style={{ animation: 'blink 1.4s infinite', marginLeft: '4px' }}>‚Ä¢‚Ä¢‚Ä¢</span>\n                <style>{`\n                  @keyframes blink {\n                    0%, 20%, 50%, 80%, 100% { opacity: 1; }\n                    40% { opacity: 0.5; }\n                    60% { opacity: 0.7; }\n                  }\n                `}</style>\n              </div>\n            )}\n            {messages.map((msg, index) => {\n              // Render error messages with retry button\n              if (msg.isError) {\n                return (\n                  <div key={index} style={{ marginBottom: '10px', padding: '10px', borderRadius: '8px', background: 'rgba(220, 53, 69, 0.15)', color: '#a33', borderLeft: '3px solid #dc3545' }}>\n                    <div>{msg.text}</div>\n                    <button\n                      onClick={handleRetry}\n                      style={{\n                        marginTop: '8px',\n                        padding: '6px 12px',\n                        borderRadius: '4px',\n                        border: 'none',\n                        background: '#dc3545',\n                        color: 'white',\n                        cursor: 'pointer',\n                        fontSize: '13px'\n                      }}\n                    >\n                      üîÑ Retry\n                    </button>\n                  </div>\n                );\n              }\n\n              // Render structured cards when present\n              if (msg.card) {\n                const card = msg.card;\n                if (card.type === 'weather') {\n                  const info = card.info;\n                  const isExpanded = expandedCards[card.id];\n                  return (\n                    <div key={card.id} style={{ marginBottom: '12px', padding: '12px', borderRadius: '8px', background: 'rgba(255,255,255,0.95)', color: '#222', boxShadow: '0 2px 6px rgba(0,0,0,0.08)', maxWidth: '460px' }}>\n                      <strong style={{ fontSize: '17px' }}>Weather ‚Äî {info.location}</strong>\n                      <div style={{ marginTop: '6px', fontSize: '17px' }}>{info.description} ‚Ä¢ {info.temperature}¬∞C (feels {info.feels_like}¬∞C)</div>\n                      <div style={{ fontSize: '16px', marginTop: '6px' }}>Humidity: {info.humidity}% ‚Ä¢ Wind: {info.wind_speed} m/s</div>\n                      {info.alerts && info.alerts.length > 0 && (\n                        <div style={{ marginTop: '8px', color: '#a33' }}>\n                          <strong style={{ fontSize: '16px' }}>Alerts:</strong>\n                          <ul style={{ margin: '6px 0 0 16px', fontSize: '15px' }}>\n                            {info.alerts.map((a, i) => <li key={i}>{a.message}</li>)}\n                          </ul>\n                        </div>\n                      )}\n                      {info.forecast && info.forecast.length > 0 && (\n                        <div style={{ marginTop: '8px' }}>\n                          <strong style={{ fontSize: '16px' }}>Forecast:</strong>\n                          <ul style={{ margin: '6px 0 0 16px', fontSize: '15px' }}>\n                            {(isExpanded ? info.forecast : info.forecast.slice(0,3)).map((f, i) => (\n                              <li key={i}>{f.time}: {f.temp}¬∞C ‚Äî {f.description}</li>\n                            ))}\n                          </ul>\n                        </div>\n                      )}\n                      <div style={{ marginTop: '8px', display: 'flex', gap: '8px' }}>\n                        <button onClick={() => handleToggleExpand(card.id)} style={{ padding: '8px 12px', borderRadius: '6px', border: 'none', cursor: 'pointer', background: '#3b4f1b', color: 'white', fontSize: '14px' }}>{isExpanded ? 'View less' : 'View more'}</button>\n                        <button onClick={() => handleOpenPage('weather')} style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #3b4f1b', cursor: 'pointer', background: 'white', color: '#3b4f1b', fontSize: '14px' }}>Open Weather Page</button>\n                        <button onClick={() => handleSetLocation(info.location)} style={{ padding: '8px 12px', borderRadius: '6px', border: '1px solid #3b4f1b', cursor: 'pointer', background: 'white', color: '#3b4f1b', fontSize: '14px' }}>Set as my location</button>\n                      </div>\n                    </div>\n                  );\n                }\n\n                if (card.type === 'market') {\n                  const data = card.data;\n                  const isExpanded = expandedCards[card.id];\n                  const firstLoc = data.prices && data.prices[0] ? data.prices[0].location : '';\n                  return (\n                    <div key={card.id} style={{ marginBottom: '12px', padding: '12px', borderRadius: '8px', background: 'rgba(255,255,255,0.95)', color: '#222', boxShadow: '0 2px 6px rgba(0,0,0,0.08)', maxWidth: '460px' }}>\n                      <strong style={{ fontSize: '15px' }}>Market Prices</strong>\n                      {data.prices && data.prices.length ? (\n                        <ul style={{ margin: '8px 0 0 16px', fontSize: '13px' }}>\n                          {(isExpanded ? data.prices : data.prices.slice(0,5)).map((p, i) => (\n                            <li key={i}>{p.crop} ‚Äî {p.location}: ‚Çπ{p.current_price} ({p.change >= 0 ? '+'+p.change : p.change})</li>\n                          ))}\n                        </ul>\n                      ) : (\n                        <div style={{ marginTop: '6px', fontSize: '14px' }}>No market data found.</div>\n                      )}\n                      <div style={{ marginTop: '8px', display: 'flex', gap: '8px' }}>\n                        <button onClick={() => handleToggleExpand(card.id)} style={{ padding: '6px 10px', borderRadius: '6px', border: 'none', cursor: 'pointer', background: '#3b4f1b', color: 'white' }}>{isExpanded ? 'View less' : 'View more'}</button>\n                        <button onClick={() => handleOpenPage('market')} style={{ padding: '6px 10px', borderRadius: '6px', border: '1px solid #3b4f1b', cursor: 'pointer', background: 'white', color: '#3b4f1b' }}>Open Market Page</button>\n                        {firstLoc && <button onClick={() => handleSetLocation(firstLoc)} style={{ padding: '6px 10px', borderRadius: '6px', border: '1px solid #3b4f1b', cursor: 'pointer', background: 'white', color: '#3b4f1b' }}>Set as my location</button>}\n                      </div>\n                    </div>\n                  );\n                }\n\n                if (card.type === 'crop') {\n                  const data = card.data;\n                  const isExpanded = expandedCards[card.id];\n                  return (\n                    <div key={card.id} style={{ marginBottom: '12px', padding: '12px', borderRadius: '8px', background: 'rgba(255,255,255,0.95)', color: '#222', boxShadow: '0 2px 6px rgba(0,0,0,0.08)', maxWidth: '460px' }}>\n                      <strong style={{ fontSize: '15px' }}>Crop Recommendations</strong>\n                      {data.recommendations && data.recommendations.length ? (\n                        <div>\n                          <ul style={{ margin: '8px 0 0 16px', fontSize: '13px' }}>\n                            {(isExpanded ? data.recommendations : data.recommendations.slice(0,4)).map((r, i) => (\n                                <li key={i} style={{ marginBottom: '8px' }}>\n                                  <div style={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center' }}>\n                                    <div><strong>{r.name}</strong> ‚Äî {r.duration || ''} {r.yield ? `‚Ä¢ yield: ${r.yield}` : ''}</div>\n                                    {isExpanded && (\n                                      <button onClick={() => handleSaveFavoriteCrop(r)} style={{ padding: '4px 8px', borderRadius: '6px', border: 'none', background: '#3b4f1b', color: 'white', cursor: 'pointer', fontSize: '12px' }}>Save</button>\n                                    )}\n                                  </div>\n                                  {isExpanded && (\n                                    <div style={{ fontSize: '12px', marginTop: '4px', marginLeft: '8px', color: '#444' }}>\n                                      <div>Soil: {r.soil_types ? r.soil_types.join(', ') : '‚Äî'}</div>\n                                      <div>Water: {r.water_requirement || '‚Äî'}</div>\n                                      <div>Fertilizers: {r.fertilizers ? r.fertilizers.join(', ') : '‚Äî'}</div>\n                                    </div>\n                                  )}\n                                </li>\n                              ))}\n                          </ul>\n                          <div style={{ marginTop: '8px', display: 'flex', gap: '8px' }}>\n                            <button onClick={() => handleToggleExpand(card.id)} style={{ padding: '6px 10px', borderRadius: '6px', border: 'none', cursor: 'pointer', background: '#3b4f1b', color: 'white' }}>{isExpanded ? 'View less' : 'View more'}</button>\n                          </div>\n                        </div>\n                      ) : (\n                        <div style={{ marginTop: '6px', fontSize: '14px' }}>No recommendations found.</div>\n                      )}\n                    </div>\n                  );\n                }\n              }\n\n              // Default text message rendering\n              return (\n                <div\n                  key={index}\n                  className={`message ${msg.sender}`}\n                  style={{\n                    marginBottom: '10px',\n                    padding: '10px',\n                    borderRadius: '8px',\n                    maxWidth: '80%',\n                    marginLeft: msg.sender === 'user' ? 'auto' : '0',\n                    background: msg.sender === 'user' ? '#3b4f1b' : 'rgba(255, 255, 255, 0.2)',\n                    backdropFilter: msg.sender === 'bot' ? 'blur(10px)' : 'none',\n                    color: msg.sender === 'user' ? 'white' : '#222',\n                    fontSize: '14px'\n                  }}\n                >\n                  {msg.text}\n                </div>\n              );\n            })}\n          </div>\n\n          <div style={{ padding: '15px', borderTop: '1px solid #e0e0e0' }}>\n            <div style={{ display: 'flex', gap: '10px', marginBottom: '10px' }}>\n              <input\n                type=\"text\"\n                value={inputMessage}\n                onChange={(e) => setInputMessage(e.target.value)}\n                onKeyPress={(e) => e.key === 'Enter' && handleSendMessage(inputMessage)}\n                style={{\n                  flex: 1,\n                  padding: '10px',\n                  border: '2px solid #3b4f1b',\n                  borderRadius: '5px',\n                  fontSize: '16px',\n                  background: 'rgba(255, 255, 255, 0.2)',\n                  backdropFilter: 'blur(10px)',\n                  color: '#222'\n                }}\n              />\n              <button\n                onClick={() => handleSendMessage(inputMessage)}\n                className=\"btn\"\n                style={{ padding: '10px 20px', margin: 0, fontSize: '16px' }}\n              >\n                {t.send}\n              </button>\n            </div>\n            <div style={{ display: 'flex', gap: '10px' }}>\n              <button\n                onClick={startListening}\n                className=\"btn\"\n                style={{\n                  flex: 1,\n                  padding: '10px 15px',\n                  margin: 0,\n                  background: isListening ? '#dc3545' : '#3b4f1b',\n                  fontSize: '16px'\n                }}\n                disabled={isListening}\n              >\n                üé§ Record\n              </button>\n              <button\n                onClick={toggleTalkback}\n                className=\"btn\"\n                style={{\n                  flex: 1,\n                  padding: '10px 12px',\n                  margin: 0,\n                  background: talkbackEnabled ? '#3b4f1b' : '#999',\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  gap: '6px',\n                  fontSize: '16px'\n                }}\n                title={talkbackEnabled ? 'Talkback enabled' : 'Talkback disabled'}\n              >\n                {talkbackEnabled ? 'üîä' : 'üîá'} {talkbackEnabled ? 'On' : 'Off'}\n              </button>\n            </div>\n          </div>\n        </div>\n      )}\n    </>\n  );\n}\n\nexport default VoiceAssistant;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}